# 统计分析中正常值范围的考量指南

## 问题背景

在临床研究中，当比较两组治疗效果时，如果不考虑指标是否在正常值范围内，可能导致以下问题：

1. **假阴性结论**：基线正常的患者占比过高，稀释了治疗效果
2. **误导性解读**：将"无法改善"（因为已经正常）解读为"治疗无效"
3. **效应估计偏倚**：全人群效应量被稀释

## 本研究数据的基线状态分布

| 指标 | 正常范围 | 正常比例 | 异常偏高 | 异常偏低 | 统计分析建议 |
|------|----------|---------|---------|---------|-------------|
| ALT | 7-40 U/L | **91.5%** | 8.5% | 0% | ⚠️ 天花板效应严重，应分层分析 |
| AST | 13-35 U/L | **93.4%** | 6.6% | 0% | ⚠️ 天花板效应严重，应分层分析 |
| GGT | 7-45 U/L | 83.8% | 16.2% | 0% | 可直接分析 |
| ALP | 35-100 U/L | 85.2% | 12.9% | 1.8% | 可直接分析 |
| 白蛋白 | 40-55 g/L | **98.2%** | 0.7% | 1.1% | ⚠️ 几乎无异常，分层分析无意义 |
| 胆红素 | 3.4-17.1 μmol/L | 68.6% | 31.4% | 0% | 可直接分析 |
| 肝硬度值 | 2.5-7.0 kPa | **29.9%** | **70.1%** | 0% | ✅ 最适合分析的指标 |
| 血小板 | 125-350 ×10^9/L | 72.9% | 0.5% | 26.6% | 关注偏低者 |
| HBsAg | 0-0.05 IU/mL | **0.4%** | **99.6%** | 0% | ✅ 可直接分析全人群 |

## 处理策略

### 策略1: 分层分析 (Stratified Analysis)

将患者按基线状态分层，分别分析：

```
if 基线值 > 正常上限 + 容忍度:
    分入"基线异常"组
else:
    分入"基线正常"组
    
分别报告：
- 基线异常亚组的治疗效果
- 基线正常亚组的维持效果
```

**何时使用**：
- 基线正常比例在 30%-80% 之间
- 两个亚组样本量都足够（≥20人）

### 策略2: 复常率分析 (Normalization Rate Analysis)

只分析基线异常者中恢复正常的比例：

$$\text{复常率} = \frac{\text{基线异常且终点正常的例数}}{\text{基线异常的例数}} \times 100\%$$

**何时使用**：
- 关注治疗能否使异常指标恢复正常
- 基线异常者有足够样本量

### 策略3: 维持率分析 (Maintenance Rate Analysis)

分析基线正常者终点仍正常的比例：

$$\text{维持率} = \frac{\text{基线正常且终点仍正常的例数}}{\text{基线正常的例数}} \times 100\%$$

**何时使用**：
- 基线正常比例很高（>80%）
- 关注治疗能否防止恶化

### 策略4: 效应修饰检验 (Effect Modification Test)

检验治疗效果是否因基线状态而异：

$$\Delta Y = \beta_0 + \beta_1 \cdot T + \beta_2 \cdot A + \beta_3 \cdot (T \times A) + \varepsilon$$

- $T$ = 治疗组指示变量
- $A$ = 基线异常指示变量
- $\beta_3$ = 交互作用系数

**如果 $\beta_3$ 显著 (P < 0.05)**：
→ 治疗效果在异常和正常人群中不同
→ 应分亚组报告结果

### 策略5: 敏感性分析 (Sensitivity Analysis)

排除基线正常者后重新分析，验证结论稳健性：

```python
# 主分析：全人群
result_main = analyze_all_patients()

# 敏感性分析：仅基线异常者
result_sensitivity = analyze_only_abnormal_patients()

# 比较两个结论是否一致
```

## 本研究结果解读

### 发现1: 天花板效应解释了ALT/AST无显著差异

- ALT基线正常比例: 91.5%
- AST基线正常比例: 93.4%
- **结论**：治疗无效？❌ 错误！
- **正确解读**：大多数患者本来就正常，没有改善空间

### 发现2: 肝硬度值是最佳疗效评估指标

- 基线异常比例: 70.1%（最高）
- 有足够样本量评估真实效果
- CEM分析发现P=0.042（显著）
- **结论**：中药联合治疗可能改善肝纤维化

### 发现3: AST和ALP存在效应修饰

- AST交互作用P=0.001
- ALP交互作用P=0.0003
- **含义**：治疗效果因基线状态而异
- **建议**：分亚组报告结果

### 发现4: 基线正常者的肝硬度值有差异

- 基线正常亚组P=0.039（显著）
- 治疗组维持率100% vs 对照组维持率100%
- **可能解读**：需要进一步分析变化幅度

## 建议的分析报告框架

在论文或报告中，建议按以下框架呈现结果：

### 1. 全人群分析结果
- 标准的组间比较
- 注明可能存在天花板效应

### 2. 亚组分析结果
- 基线异常亚组的分析（主要兴趣）
- 基线正常亚组的分析（次要兴趣）

### 3. 复常率和维持率
- 复常率比较（对基线异常者）
- 维持率比较（对基线正常者）

### 4. 敏感性分析
- 说明不同分析策略的一致性

### 5. 统计学说明
- 解释为何某些指标采用分层分析
- 讨论基线分布对结果的影响

## 代码实现

本项目已实现上述分析策略，运行：

```bash
python clinical_stratified_analysis.py
```

结果保存在 `result/Stratified/` 文件夹：
- `baseline_status_distribution.csv` - 基线状态分布
- `stratified_summary.csv` - 分层分析汇总
- `stratified_report.md` - 详细分析报告

## 参考文献

1. Ceiling and Floor Effects in Clinical Research. J Clin Epidemiol, 2019.
2. Effect Modification and Interaction. Epidemiology, 2020.
3. Subgroup Analysis in Randomized Controlled Trials. BMJ, 2015.
